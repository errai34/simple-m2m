
hom2m_sc1d.py
 hom2m library for simple-cylinder1d data

### analysis of Vz distribution after finding excess of negative Vz

vzdistTGAS.py
 vz calculation purely from TGAS data.

### run hom2m using the output of densv2m1d_fstar_sample.py

hom2m-omega-densv2m.py
 omega fit

hom2m-densv2m_obsamp.py
 zsun fit

### run hom2m using the output of simple 1D selection. 

hom2m-omega-densv2m.py
 use zsun and wsun input, and calculate omega

hom2m-densv2m.py
 use both density and velocity information
 omega section does not work. 

hom2m_simple1d.py
 only use density information 

### simple R=0.1 kpc cylinder 1D density for F star
 calculate density and <v^2> at different z by randomly displacing the data using the error

densv2m1d_fstar_sample.py

### simple R=0.1 or 0.2 kpc cylinder 1D density for F star
 calculate density at different z, and output the stellar position within the cylinder.

dens1d_fstar.py

F star colour range from 
Table 5 from http://adsabs.harvard.edu/abs/2013ApJS..208....9P 
http://www.pas.rochester.edu/~emamajek/EEM_dwarf_UBVIJHK_colors_Teff.txt

F9 ... Mv=4.15
G9 ... Mv=5.55

Mv=V-5.0*log10 d(pc) +5.0
Mv=VTmag-5.0*log10(1000.0/Plx)+5.0
* V=11, and Mv=4.15
 dlim = 234.4 pc
 dz within the cylinder of 0.1 kpc radius zlim= 212 pc
 dz within the cylinder of 0.2 kpc radius zlim= 122 pc
* V=11.5
 dlim=295.1 pc
 dz within the cylinder of 0.1 kpr radius zlim=0.277
 dz within the cylinder of 0.2 kpc radius zlim=0.22


--- conversion to physical values from Jo

Holmberg & Flynn (2000) 0.102pm0.010
For F stars, they got 8.3pm0.3 km/s

For an isothermal distribution in the HO potential for a single data point

ln p(z,vz) =  -0.5 x ( omega^2 z^2 + vz^2)/sigma_z^2 - ln (\sigma_z^2/ omega)

and for many data points

ln L = \sum_i ln p(z_i,vz_i) =  -0.5 x \sum_i ( omega^2 z_i^2 + vz_i^2)/ sigma_z^2 - N ln (\sigma_z^2/ omega)

Maximum likelihood of this gives

d ln L / d sigma_z^2 ~ \sum_i (omega^2 z_i^2 + vz_i^2) / sigma_z^4 / 2  - N/sigma_z^2 = 0

or

omega_^2 <z^2> + <vz^2> = 2 sigma^2

and

d ln L / d omega = - omega \sum_i z_i^2 / sigma_z^2 +N / omega ===> omega^2 =N \sigma_z^2 /  \sum_i z_i^2 = \sigma_z^2 / <z^2>

so 

sigma_z^2 = <vz^2>
omega^2 = <vz^2> / <z^2>

For an exponential

<z^2> = \int dz z^2 exp(-z/zd) = zd^2 \int dx x^2 exp(-x) = 2 zd^2

so

omega^2 = sigma_z^2 / z_d^2 / 2 ===> omega = \sigma_z / zd / sqrt(2)

[For a sech^2 profile <z^2> = pi^2/3 zd^2 ~ 1.8^2 zd^2]. So I think we were both off by factors of sqrt(2)! Maybe I messed up a factor of two again though...



The conversion goes as 

4pi G rho ~ omega^2 [Poisson equation]


rho = (omega/100 km/s/kpc)^2 x 0.1849 Msun / pc^3

or in terms of the period

rho = (period / 100 Myr)^-2 x 0.0698 Msun / pc^2
